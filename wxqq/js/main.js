var wxqqEditor=null;ZeroClipboard.config({swfPath:"./js/ZeroClipboard/ZeroClipboard.swf"});var client=new ZeroClipboard(document.getElementById("copyAllWxqqEditor"));wxqqEditor=UE.getEditor("editorContent",{toolbars:[["bold","italic","underline","forecolor","backcolor","txtshadow","|","justifyleft","justifycenter","justifyright","justifyjustify","indent","rowspacingtop","rowspacingbottom","lineheight","|","removeformat","formatmatch","autotypeset"],["paragraph","fontfamily","fontsize","inserttable","background","uploadword","insertimage","insertvideo","horizontal","spechars","|","undo","redo","|","more"],["source","blockquote","superscript","subscript","insertorderedlist","insertunorderedlist","emotion","link","searchreplace","help","message"]],autoHeightEnabled:!1,elementPathEnabled:!1,wordCount:!1}),wxqqEditor.ready(function(){$(window).trigger("resize"),setTimeout(function(){$("#edui1_iframeholder").height($(window).height()-137),$(".editor2").height($(window).height()-137),$("#style-operate-area .w1").height($(window).height()-37),$("#style-operate-area #insert-style-list").height($(window).height()-77),$(".edui-editor-toolbarboxinner").children().eq(1).append('<button id="tbmore" style="background:#ffe69f;padding:2px;border:0;"><i class="fa fa-plus-square" style="color:#888;"></i> 更多</button>'),$(".edui-editor-toolbarboxinner").children().eq(2).css({backgroundColor:"#F7F4F3"}).hide(),$("#tbmore").click(function(o){$(".edui-editor-toolbarboxinner").children().eq(2).toggle(),o.preventDefault()}),wxqqEditor.execCommand("focus")}),setInterval(function(){wxqqEditor.getContent().length>200&&(window.localStorage._wxqqTmpContent=wxqqEditor.getContent(),$.toaster({message:"成功为你缓存一次本地数据",title:"本地保存成功(每隔10秒自动保存)",priority:"success",timeout:9e4}))},1e4),console.log($.cookie("editorTmp")),window.localStorage._wxqqTmpContent&&wxqqEditor.setContent(window.localStorage._wxqqTmpContent)}),$(function(){$('[data-toggle="tooltip"]').tooltip(),$(document).on("click","#insert-style-list .ui-portlet-list > li,#styleSearchResultList #style_search_list > ul > li",function(){if($(this).hasClass("ignore"))return!1;var o=!1,t=parseInt($(this).find(".autonum:first").text()),e=$(this).data("id");$(this).contents().filter(function(){return 3===this.nodeType&&""==$.trim($(this).text())}).remove(),$(this).find("p").each(function(){"&nbsp;"==$.trim($(this).html())&&$(this).html("<br/>")}),$(this).find("*").each(function(){$(this).attr("data-width")||this.style.width&&""!=this.style.width&&this.style.width.search("%")>0&&$(this).attr("data-width",this.style.width)});var r=$(this).find("> .wxqq:first");if(r.size())if(1==r.find("> *").size()&&r.find("> *").eq(0).hasClass("wxqq"))o=wxqqEditor.execCommand("insertHtml",r.html()+"<p><br/></p>");else{var i=r.prop("outerHTML");o=wxqqEditor.execCommand("insertHtml",i+"<p><br/></p>")}else o=wxqqEditor.execCommand("insertHtml",'<section data-id="'+e+'" class="wxqq">'+$(this).html()+'<section style="display: block; width: 0; height: 0; clear: both;"></section></section><p><br/></p>');o&&("undefined"!=typeof t&&$(this).find(".autonum:first").text(t+1),style_click($(this).data("id")))}),$(".nav .dropdown,.navbar-nav .dropdown,header .dropdown").hover(function(o){$(this).addClass("open")},function(){$(this).removeClass("open")}).click(function(o){o.stopPropagation()}),$("#bg-choose .chooser").on("click",function(){""!=$(this).data("url")&&$("body").css({background:"url("+$(this).data("url")+")"})}),$("#clearWxqqEditor").on("click",function(){confirm("你确定要清空所有内容,无法恢复哦?")&&(wxqqEditor.setContent(""),wxqqEditor.focus())}),$("#previewEditor").on("click",function(){$("#previewBox").html(wxqqEditor.getContent()),$("#preview-msg").modal("show")}),client.on("copy",function(o){o.clipboardData.setData("text/html",wxqqEditor.getContent()),$.toaster({message:"请在微信后台ctrl+v即可",title:"复制成功",priority:"success",timeout:9e4})}),$("#right-fix-tab a").on("click",function(o){$(this).tab("show"),o.preventDefault()}),$("#custom-color-text").colorPicker({customBG:"#222",size:2,readOnly:!1,mode:"hsv-h",init:function(o,t){o.style.backgroundColor=o.value,o.style.color=t.rgbaMixCustom.luminance>.22?"#222":"#ddd"},displayCallback:function(o,t,e){$(".editor-template-list").find(".wxqq-bg").css({backgroundColor:"#"+o.HEX}),$(".editor-template-list").find(".wxqq-borderTopColor,.wxqq-borderLeftColor,.wxqq-borderRightColor,.wxqq-borderBottomColor").css({borderColor:"#"+o.HEX})}}).each(function(o,t){}),$(".color-swatch").on("click",function(){var o=wxqqEditor.selection.getRange(),t=o.startContainer;$("#replace-color-all").prop("checked")?($(wxqqEditor.document).find(".wxqq-bg").css({backgroundColor:$(this).css("background-color")}),$(wxqqEditor.document).find(".wxqq-borderTopColor,.wxqq-borderLeftColor,.wxqq-borderRightColor,.wxqq-borderBottomColor").css({borderColor:$(this).css("background-color")})):($(t).hasClass("wxqq-bg")?$(t).css({backgroundColor:$(this).css("background-color")}):$(t).parents(".wxqq-bg").css({backgroundColor:$(this).css("background-color")}),$(t).hasClass("wxqq-borderTopColor")?$(t).css({borderTopColor:$(this).css("background-color")}):$(t).parents(".wxqq-borderTopColor").css({borderTopColor:$(this).css("background-color")}),$(t).hasClass("wxqq-borderLeftColor")?$(t).css({borderLeftColor:$(this).css("background-color")}):$(t).parents(".wxqq-borderLeftColor").css({borderLeftColor:$(this).css("background-color")}),$(t).hasClass("wxqq-borderRightColor")?$(t).css({borderRightColor:$(this).css("background-color")}):$(t).parents(".wxqq-borderRightColor").css({borderRightColor:$(this).css("background-color")}),$(t).hasClass("wxqq-borderBottomColor")?$(t).css({borderBottomColor:$(this).css("background-color")}):$(t).parents(".wxqq-borderBottomColor").css({borderBottomColor:$(this).css("background-color")}))}),$.ajax({url:"http://www.weixinquanquan.com/index.php?s=/Home/New/index&callback=?",dataType:"jsonp",success:function(o){$(".editor-template-list").html(o.code),$(".editor-template-list li").hide(),$(".editor-template-list").find(".wxqq-tpl1").show()}}),$("#left-operate-menu .filter").on("click",function(){var o=$(this);o.parent().addClass("active").siblings().removeClass("active"),"all"!=o.data("filter")?($(".editor-template-list li").hide(),$(".editor-template-list").find(".wxqq-"+o.data("filter")).show()):$(".editor-template-list li").show()})});